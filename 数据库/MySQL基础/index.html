<!DOCTYPE html>
<html lang=en>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>MySQL基础 | Blog Of TheMasterplan</title>
  <meta name="description" content="一.基础 二.增删改 三.查询  DISTINCT  LIMIT   四.排序 五.过滤 六.通配符 七.正则表达式 八.计算字段 九.函数 十.分组 十一.子查询 十二.JOIN  内连接  自连接  外部连接   十三.UNION 十四.视图 十五.事务管理 十六.安全管理 十七.范式 参考 一.基础 注释： 1234## 注释-- 注释&#x2F;* 注释   注释*&#x2F;  查看数据库和表信息： 123">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL基础">
<meta property="og:url" content="http://thmasterplan.cn/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL%E5%9F%BA%E7%A1%80/index.html">
<meta property="og:site_name" content="TheMasterplan">
<meta property="og:description" content="一.基础 二.增删改 三.查询  DISTINCT  LIMIT   四.排序 五.过滤 六.通配符 七.正则表达式 八.计算字段 九.函数 十.分组 十一.子查询 十二.JOIN  内连接  自连接  外部连接   十三.UNION 十四.视图 十五.事务管理 十六.安全管理 十七.范式 参考 一.基础 注释： 1234## 注释-- 注释&#x2F;* 注释   注释*&#x2F;  查看数据库和表信息： 123">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-11-18T04:30:33.000Z">
<meta property="article:modified_time" content="2021-01-29T15:00:41.306Z">
<meta property="article:author" content="LSJ">
<meta property="article:tag" content="MySQL">
<meta name="twitter:card" content="summary">
  <!-- Canonical links -->
  <link rel="canonical" href="http://thmasterplan.cn/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL%E5%9F%BA%E7%A1%80/index.html">
  
    <link rel="alternate" href="/atom.xml" title="TheMasterplan" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
    <link href="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.3.5/dist/jquery.fancybox.min.css" rel="stylesheet">
  
  
<meta name="generator" content="Hexo 4.2.1"></head>


<body class="main-center theme-white" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://github.com/Laishiji" target="_blank">
          <img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">TheMasterplan</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">Java Developer</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="Search" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="Type something..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">Home</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">Archives</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">Categories</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">Repository</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">About</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/Laishiji" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">Board</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>欢迎访问~</p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">Categories</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/JVM/">JVM</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaWeb/">JavaWeb</a><span class="category-list-count">17</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java%E5%B9%B6%E5%8F%91/">Java并发</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E9%A1%B9/">杂项</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/">软件工程</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%A1%B9%E7%9B%AE%E4%BC%98%E5%8C%96/">项目优化</a><span class="category-list-count">3</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/CentOS7/" style="font-size: 13.75px;">CentOS7</a> <a href="/tags/Git/" style="font-size: 13px;">Git</a> <a href="/tags/JVM/" style="font-size: 13.38px;">JVM</a> <a href="/tags/Java/" style="font-size: 14px;">Java</a> <a href="/tags/JavaWeb/" style="font-size: 13.63px;">JavaWeb</a> <a href="/tags/Java%E5%B9%B6%E5%8F%91/" style="font-size: 13.88px;">Java并发</a> <a href="/tags/Maven/" style="font-size: 13px;">Maven</a> <a href="/tags/MyBatis/" style="font-size: 13.13px;">MyBatis</a> <a href="/tags/MySQL/" style="font-size: 13.5px;">MySQL</a> <a href="/tags/Redis/" style="font-size: 13px;">Redis</a> <a href="/tags/Spring/" style="font-size: 13.5px;">Spring</a> <a href="/tags/SpringBoot/" style="font-size: 13px;">SpringBoot</a> <a href="/tags/%E6%9D%82%E9%A1%B9/" style="font-size: 13.38px;">杂项</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 13px;">设计模式</a> <a href="/tags/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/" style="font-size: 13.13px;">软件工程</a> <a href="/tags/%E9%A1%B9%E7%9B%AE%E4%BC%98%E5%8C%96/" style="font-size: 13.25px;">项目优化</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">Archive</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a><span class="archive-list-count">23</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a><span class="archive-list-count">10</span></li></ul>
    </div>
  </div>


    
  </div>
</aside>

  
  
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">Catalogue</h3>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#一-基础"><span class="toc-number">1.</span> <span class="toc-text">一.基础</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#二-增删改"><span class="toc-number">2.</span> <span class="toc-text">二.增删改</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#三-查询"><span class="toc-number">3.</span> <span class="toc-text">三.查询</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#DISTINCT"><span class="toc-number">3.1.</span> <span class="toc-text">DISTINCT</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LIMIT"><span class="toc-number">3.2.</span> <span class="toc-text">LIMIT</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#四-排序"><span class="toc-number">4.</span> <span class="toc-text">四.排序</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#五-过滤"><span class="toc-number">5.</span> <span class="toc-text">五.过滤</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#六-通配符"><span class="toc-number">6.</span> <span class="toc-text">六.通配符</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#七-正则表达式"><span class="toc-number">7.</span> <span class="toc-text">七.正则表达式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#八-计算字段"><span class="toc-number">8.</span> <span class="toc-text">八.计算字段</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#九-函数"><span class="toc-number">9.</span> <span class="toc-text">九.函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#十-分组"><span class="toc-number">10.</span> <span class="toc-text">十.分组</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#十一-子查询"><span class="toc-number">11.</span> <span class="toc-text">十一.子查询</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#十二-JOIN"><span class="toc-number">12.</span> <span class="toc-text">十二.JOIN</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#内连接"><span class="toc-number">12.1.</span> <span class="toc-text">内连接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#自连接"><span class="toc-number">12.2.</span> <span class="toc-text">自连接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#外部连接"><span class="toc-number">12.3.</span> <span class="toc-text">外部连接</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#十三-UNION"><span class="toc-number">13.</span> <span class="toc-text">十三.UNION</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#十四-视图"><span class="toc-number">14.</span> <span class="toc-text">十四.视图</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#十五-事务管理"><span class="toc-number">15.</span> <span class="toc-text">十五.事务管理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#十六-安全管理"><span class="toc-number">16.</span> <span class="toc-text">十六.安全管理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#十七-范式"><span class="toc-number">17.</span> <span class="toc-text">十七.范式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#作用"><span class="toc-number">17.1.</span> <span class="toc-text">作用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">17.2.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#参考"><span class="toc-number">18.</span> <span class="toc-text">参考</span></a></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-MySQL基础" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      MySQL基础
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL%E5%9F%BA%E7%A1%80/" class="article-date">
	  <time datetime="2020-11-18T04:30:33.000Z" itemprop="datePublished">2020-11-18</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>
  </span>

        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link" href="/tags/MySQL/" rel="tag">MySQL</a>
  </span>


        

        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL%E5%9F%BA%E7%A1%80/#comments" class="article-comment-link">Comments</a></span>
        
	
		<span class="post-wordcount hidden-xs" itemprop="wordCount">Word Count: 3.7k(words)</span>
	
	

      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <p><a href="#一-基础">一.基础</a></p>
<p><a href="#二-增删改">二.增删改</a></p>
<p><a href="#三-查询">三.查询</a></p>
<ul>
<li><p><a href="#DISTINCT">DISTINCT</a></p>
</li>
<li><p><a href="#LIMIT">LIMIT</a></p>
</li>
</ul>
<p><a href="#四-排序">四.排序</a></p>
<p><a href="#五-过滤">五.过滤</a></p>
<p><a href="#六-通配符">六.通配符</a></p>
<p><a href="#七-正则表达式">七.正则表达式</a></p>
<p><a href="#八-计算字段">八.计算字段</a></p>
<p><a href="#九-函数">九.函数</a></p>
<p><a href="#十-分组">十.分组</a></p>
<p><a href="#十一-子查询">十一.子查询</a></p>
<p><a href="#十二-JOIN">十二.JOIN</a></p>
<ul>
<li><p><a href="#内连接">内连接</a></p>
</li>
<li><p><a href="#自连接">自连接</a></p>
</li>
<li><p><a href="#外部连接">外部连接</a></p>
</li>
</ul>
<p><a href="#十三-UNION">十三.UNION</a></p>
<p><a href="#十四-视图">十四.视图</a></p>
<p><a href="#十五-事务管理">十五.事务管理</a></p>
<p><a href="#十六-安全管理">十六.安全管理</a></p>
<p><a href="十七-范式">十七.范式</a></p>
<p><a href="#参考">参考</a></p>
<h1 id="一-基础"><a href="#一-基础" class="headerlink" title="一.基础"></a>一.基础</h1><ol>
<li><p>注释：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 注释</span></span><br><span class="line"><span class="comment">-- 注释</span></span><br><span class="line"><span class="comment">/* 注释</span></span><br><span class="line"><span class="comment">   注释*/</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>查看数据库和表信息：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">DATABASES</span>; <span class="comment">-- 查询所有数据库</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">TABLES</span>; <span class="comment">-- 查看所有表</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 以下语句效果相同：查看单表的信息</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">COLUMNS</span> <span class="keyword">FROM</span> my_table;</span><br><span class="line">DESC my_table;</span><br><span class="line"><span class="keyword">EXPLAIN</span> my_table;</span><br><span class="line"><span class="keyword">DESCRIBE</span> my_table;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建和使用数据库：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> <span class="keyword">test</span>;</span><br><span class="line"><span class="keyword">USE</span> <span class="keyword">test</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>SHOW命令：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">STATUS</span>; <span class="comment">-- 显示服务器状态信息</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">GRANTS</span>; <span class="comment">-- 显示授权用户的权限</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">ERRORS</span>;</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">WARNINGS</span>; <span class="comment">-- 显示错误与警告信息</span></span><br><span class="line"><span class="keyword">HELP</span> <span class="keyword">SHOW</span>; <span class="comment">-- 查看所有SHOW的用法</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建和操纵表：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 实际生产中，所有字段最好都设置为NOT NULL,以避免NPE</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> my_table (</span><br><span class="line">  <span class="comment">-- int 类型，不为空，自增</span></span><br><span class="line">  <span class="keyword">id</span> <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="comment">-- int 类型，不可为空，默认值为 1，不为空</span></span><br><span class="line">  col1 <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>,</span><br><span class="line">  <span class="comment">-- 变长字符串类型，最长为 45 个字符，可为空</span></span><br><span class="line">  col2 <span class="built_in">VARCHAR</span>(<span class="number">45</span>) <span class="literal">NULL</span>,</span><br><span class="line">  <span class="comment">-- 日期类型，可为空</span></span><br><span class="line">  col3 <span class="built_in">DATE</span> <span class="literal">NULL</span>, </span><br><span class="line">  <span class="comment">-- 设置主键为 id</span></span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="keyword">id</span>)</span><br><span class="line">)<span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加列</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> my_table <span class="keyword">ADD</span> col4 <span class="built_in">CHAR</span>(<span class="number">45</span>);</span><br><span class="line"><span class="comment">-- 删除列</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> my_table <span class="keyword">DROP</span> <span class="keyword">COLUMN</span> col4;</span><br><span class="line"><span class="comment">-- 删除表</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> my_table;</span><br><span class="line"><span class="comment">-- 重命名表</span></span><br><span class="line"><span class="keyword">RENAME</span> <span class="keyword">TABLE</span> my_table <span class="keyword">TO</span> my_table2;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="二-增删改"><a href="#二-增删改" class="headerlink" title="二.增删改"></a>二.增删改</h1><ol>
<li><p>插入</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 插入完整一行</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> my_table <span class="keyword">VALUES</span>(<span class="literal">null</span>, <span class="number">2</span>, <span class="string">'col2'</span>, <span class="string">'2020-11-11'</span>);</span><br><span class="line"><span class="comment">-- 插入行的部分字段数据</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> my_table(col1,col2) <span class="keyword">VALUES</span>(<span class="number">2</span>, <span class="string">'col2'</span>);</span><br><span class="line"><span class="comment">-- 插入多行, 用逗号分割即可</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> my_table <span class="keyword">VALUES</span>(<span class="literal">null</span>, <span class="number">2</span>, <span class="string">'col2'</span>, <span class="string">'2020-11-11'</span>),(<span class="literal">null</span>, <span class="number">3</span>, <span class="string">'col2'</span>, <span class="string">'2020-12-12'</span>);</span><br><span class="line"><span class="comment">-- 插入查询结果</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> new_table <span class="keyword">AS</span> my_table <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> my_table;</span><br></pre></td></tr></table></figure>
</li>
<li><p>更新</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> my_table <span class="keyword">SET</span> col1=<span class="number">10</span>, col2=<span class="string">'hhh'</span> <span class="keyword">WHERE</span> <span class="keyword">id</span>=<span class="number">1</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> my_table <span class="keyword">WHERE</span> <span class="keyword">id</span>=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除整张表</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> my_table;</span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> my_table;</span><br></pre></td></tr></table></figure>
<p><strong>两者的区别</strong>：DELETE是删除表的所有行，TRUNCATE是直接删除整张表再新建一张空表，因此后者更快。</p>
</li>
</ol>
<h1 id="三-查询"><a href="#三-查询" class="headerlink" title="三.查询"></a>三.查询</h1><h2 id="DISTINCT"><a href="#DISTINCT" class="headerlink" title="DISTINCT"></a>DISTINCT</h2><p>去重。它作用于列出的所有列，只有所有列的值完全相同才会被去重。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> col1,col2 <span class="keyword">FROM</span> my_table;</span><br></pre></td></tr></table></figure>
<h2 id="LIMIT"><a href="#LIMIT" class="headerlink" title="LIMIT"></a>LIMIT</h2><p>限制返回结果的函数。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 只有一个参数</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> my_table <span class="keyword">LIMIT</span> <span class="number">5</span>; <span class="comment">-- 只返回前5行，即1，2，3，4，5行</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 有两个参数</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> my_table <span class="keyword">LIMIT</span> <span class="number">5</span>,<span class="number">5</span>; <span class="comment">-- 返回从第6行开始的5行，即6，7，8，9，10行</span></span><br></pre></td></tr></table></figure>
<h1 id="四-排序"><a href="#四-排序" class="headerlink" title="四.排序"></a>四.排序</h1><p>使用ORDER BY子句。ASC，升序（默认）；DESC，降序。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> my_table <span class="keyword">ORDER</span> <span class="keyword">BY</span> col1 <span class="keyword">DESC</span>, COL2 <span class="keyword">ASC</span>;</span><br></pre></td></tr></table></figure>
<h1 id="五-过滤"><a href="#五-过滤" class="headerlink" title="五.过滤"></a>五.过滤</h1><p>不进行过滤的数据非常大，导致通过网络传输了多余的数据，从而浪费了网络带宽。因此尽量使用 SQL 语句来过滤不必要的数据，而不是传输所有的数据到客户端中然后由客户端进行过滤。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> my_table <span class="keyword">WHERE</span> col1 <span class="keyword">BETWEEN</span> <span class="number">2</span> <span class="keyword">AND</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure>
<p>WHERE子句操作符如下表：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">操作符</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">=</td>
<td style="text-align:center">等于</td>
</tr>
<tr>
<td style="text-align:center">&lt;&gt;或!=</td>
<td style="text-align:center">不等于</td>
</tr>
<tr>
<td style="text-align:center">&lt;</td>
<td style="text-align:center">小于</td>
</tr>
<tr>
<td style="text-align:center">&gt;</td>
<td style="text-align:center">大于</td>
</tr>
<tr>
<td style="text-align:center">&lt;=</td>
<td style="text-align:center">小于等于</td>
</tr>
<tr>
<td style="text-align:center">&gt;=</td>
<td style="text-align:center">大于等于</td>
</tr>
<tr>
<td style="text-align:center">BETWEEN … AND …</td>
<td style="text-align:center">在两个值之间</td>
</tr>
<tr>
<td style="text-align:center">IS NULL</td>
<td style="text-align:center">匹配NULL值</td>
</tr>
</tbody>
</table>
</div>
<p><strong>AND 和 OR</strong> 用于连接多个过滤条件。默认AND的优先级更高，当一个过滤表达式涉及到多个 AND 和 OR 时，可以使用 () 来决定优先级，使得优先级关系更清晰。</p>
<p><strong>IN</strong> 用于匹配一组值，其后也可以接一个 SELECT 子句，从而匹配子查询得到的一组值。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> my_table <span class="keyword">WHERE</span> col1 <span class="keyword">IN</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>);</span><br></pre></td></tr></table></figure>
<p><strong>NOT</strong> 用于否定一个条件。MySQL支持使用其对 <strong>IN</strong>、<strong>BETWEEN</strong> 和 <strong>EXISTS</strong>子句取反。</p>
<h1 id="六-通配符"><a href="#六-通配符" class="headerlink" title="六.通配符"></a>六.通配符</h1><p><strong>LIKE</strong> 操作符指示MySQL其后跟的搜索模式利用通配符匹配而非直接相等匹配。注意根据MySQL的配置方式，匹配可以是区分大小写的。</p>
<ul>
<li><code>%</code> 表示任何字符出现任意次数。注意单个<code>%</code> 无法匹配NULL。</li>
<li><code>_</code> 表示匹配任意单个字符。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> my_table <span class="keyword">WHERE</span> col2 <span class="keyword">LIKE</span> <span class="string">'%abc%'</span>; <span class="comment">-- 匹配列col2所有含有abc片段的列值</span></span><br></pre></td></tr></table></figure>
<h1 id="七-正则表达式"><a href="#七-正则表达式" class="headerlink" title="七.正则表达式"></a>七.正则表达式</h1><p>MySQL仅支持正则表达式的一个子集，使用 <strong>REGEXP</strong> 操作符。</p>
<p>MySQL中的正则表达式匹配不区分大小写，若要区分，可在 <strong>REGEXP</strong> 后使用 <strong>BINARY</strong> 关键字。</p>
<ol>
<li><p>基本字符匹配</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> my_table <span class="keyword">WHERE</span> col2 REGEXP <span class="built_in">BINARY</span> <span class="string">'.abc'</span>;</span><br></pre></td></tr></table></figure>
<p><code>.</code>表示匹配任意单个字符。</p>
</li>
<li><p>OR匹配</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> my_table <span class="keyword">WHERE</span> col2 REGEXP <span class="built_in">BINARY</span> <span class="string">'.abc | ABC'</span>;</span><br></pre></td></tr></table></figure>
<p>使用<code>|</code>表示条件或。</p>
</li>
<li><p>匹配几个字符之一</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> my_table <span class="keyword">WHERE</span> col2 REGEXP <span class="string">'[abc]'</span>;</span><br></pre></td></tr></table></figure>
<p>使用<code>[abc]</code>定义一组字符，它的含义是匹配a或匹配b或匹配c。</p>
<p>可在<code>[]</code>开头使用<code>^</code>表示匹配除了<code>[]</code>中指定字符以外的所有字符。例如<code>[^abc]</code>表示匹配除了这三个字符以外的所有字符。</p>
</li>
<li><p>匹配范围</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> my_table <span class="keyword">WHERE</span> col2 REGEXP <span class="string">'[1-3]'</span>; <span class="comment">-- 匹配1或2或3</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> my_table <span class="keyword">WHERE</span> col2 REGEXP <span class="string">'[a-f]'</span>; <span class="comment">-- 匹配a到f</span></span><br></pre></td></tr></table></figure>
<p>在<code>[]</code>中使用<code>-</code>表示匹配一个范围。</p>
</li>
<li><p>匹配特殊字符</p>
<p>为了匹配特殊字符，需要使用<code>\\</code>作为转义字符。例如<code>\\-</code>匹配<code>-</code>，<code>\\.</code>匹配<code>.</code>。</p>
</li>
<li><p>定位符</p>
<p>使用<code>^</code>锚定文本的开始，使用<code>$</code>锚定文本的结尾。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> my_table <span class="keyword">WHERE</span> col2 REGEXP <span class="string">'^[ab]bug$'</span>; <span class="comment">-- 匹配以a或b开头，以g结尾的值</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>匹配多个实例</p>
</li>
</ol>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">元字符</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">*</td>
<td style="text-align:center">匹配前面的子表达式零次或多次。例如，zo<em> 能匹配 “z” 以及 “zoo”。</em> 等价于{0,}。</td>
</tr>
<tr>
<td style="text-align:center">+</td>
<td style="text-align:center">匹配前面的子表达式一次或多次。例如，’zo+’ 能匹配 “zo” 以及 “zoo”，但不能匹配 “z”。+ 等价于 {1,}。</td>
</tr>
<tr>
<td style="text-align:center">{n}</td>
<td style="text-align:center">n 是一个非负整数。匹配确定的 n 次。例如，’o{2}’ 不能匹配 “Bob” 中的 ‘o’，但是能匹配 “food” 中的两个 o。</td>
</tr>
<tr>
<td style="text-align:center">{n,m}</td>
<td style="text-align:center">m 和 n 均为非负整数，其中n &lt;= m。最少匹配 n 次且最多匹配 m 次。</td>
</tr>
</tbody>
</table>
</div>
<h1 id="八-计算字段"><a href="#八-计算字段" class="headerlink" title="八.计算字段"></a>八.计算字段</h1><p>在数据库服务器上完成数据的转换和格式化的工作往往比客户端上快得多，并且转换和格式化后的数据量更少的话可以减少网络通信量。</p>
<p>计算字段通常需要使用 <strong>AS</strong> 来取别名，否则输出的时候字段名为计算表达式。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column1 * column2 <span class="keyword">AS</span> <span class="keyword">alias</span> <span class="keyword">FROM</span> my_table; <span class="comment">-- MySQL支持+, -, *, /</span></span><br></pre></td></tr></table></figure>
<p><strong>CONCAT()</strong> 用于连接两个字段。许多数据库会使用空格把一个值填充为列宽，因此连接的结果会出现一些不必要的空格，使用 <strong>TRIM()</strong> 可以去除首尾空格。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="keyword">TRIM</span>(col1), <span class="string">'('</span>, <span class="keyword">TRIM</span>(col2), <span class="string">')'</span>) <span class="keyword">AS</span> concat_col <span class="keyword">FROM</span> mytable;</span><br></pre></td></tr></table></figure>
<h1 id="九-函数"><a href="#九-函数" class="headerlink" title="九.函数"></a>九.函数</h1><p>MySQL函数可分为文本处理函数，日期和时间处理函数，数值处理函数，聚集函数等。</p>
<p>其中聚集函数是运行在行组上，计算和返回单个值的函数，如下表所示：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">函 数</th>
<th style="text-align:center">说 明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">AVG()</td>
<td style="text-align:center">返回某列的平均值，忽略NULL</td>
</tr>
<tr>
<td style="text-align:center">COUNT()</td>
<td style="text-align:center">返回某列的行数</td>
</tr>
<tr>
<td style="text-align:center">MAX()</td>
<td style="text-align:center">返回某列的最大值</td>
</tr>
<tr>
<td style="text-align:center">MIN()</td>
<td style="text-align:center">返回某列的最小值</td>
</tr>
<tr>
<td style="text-align:center">SUM()</td>
<td style="text-align:center">返回某列值之和</td>
</tr>
</tbody>
</table>
</div>
<p>使用 DISTINCT 可以汇总不同的值。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">AVG</span>(<span class="keyword">DISTINCT</span> col1) <span class="keyword">AS</span> avg_col <span class="keyword">FROM</span> my_table;</span><br></pre></td></tr></table></figure>
<p>其余函数可参考：<a href="https://www.runoob.com/mysql/mysql-functions.html" target="_blank" rel="noopener">MySQL函数|菜鸟教程</a>。</p>
<h1 id="十-分组"><a href="#十-分组" class="headerlink" title="十.分组"></a>十.分组</h1><p>使用 <strong>GROUP BY</strong>子句指定某列，该列相同的值则划为一组。</p>
<p>可以对同一分组数据使用聚集函数进行处理，例如求同一分组中某列的平均值等。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">AVG</span>(col1) <span class="keyword">AS</span> col1_avg <span class="keyword">FROM</span> mytable <span class="keyword">GROUP</span> <span class="keyword">BY</span> col2;</span><br></pre></td></tr></table></figure>
<p>使用 <strong>HAVING</strong> 子句指定分组的过滤条件。WHERE 过滤行，优先级高于 <strong>HAVING</strong>。</p>
<p>分组规定：</p>
<ol>
<li>GROUP BY子句可以包含任意数目的列，这使得能对分组进行嵌套，进行更细致的分组。</li>
<li>如果嵌套了分组，数据将在最后规定的分组上进行汇总。</li>
<li>GROUP BY子句中列出的每个列都必须是检索列或有效的表达式。</li>
<li>除聚集函数计算语句外，SELECT语句中的每个列都必须在GROUP BY子句中给出。</li>
<li>如果分组中有NULL值，则NULL将作为一个分组。</li>
<li>关键字的顺序：WHERE &gt; GROUP BY &gt; HAVING &gt; ORDER BY &gt; LIMIT。</li>
</ol>
<h1 id="十一-子查询"><a href="#十一-子查询" class="headerlink" title="十一.子查询"></a>十一.子查询</h1><p><strong>子查询中只能返回一个字段的数据</strong>。</p>
<p>可以将子查询的结果作为 WHRER 语句的过滤条件：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> my_table1 <span class="keyword">WHERE</span> col1 <span class="keyword">IN</span> </span><br><span class="line">                                  (<span class="keyword">SELECT</span> col2 <span class="keyword">FROM</span> my_table2);</span><br></pre></td></tr></table></figure>
<p><strong>子查询作为计算字段</strong>：下面的语句可以检索出客户的订单数量，子查询语句会对第一个查询检索出的每个客户执行一次。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name, (<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*)</span><br><span class="line">                   <span class="keyword">FROM</span> Orders</span><br><span class="line">                   <span class="keyword">WHERE</span> Orders.cust_id = Customers.cust_id)</span><br><span class="line">                   <span class="keyword">AS</span> orders_num</span><br><span class="line"><span class="keyword">FROM</span> Customers <span class="keyword">ORDER</span> <span class="keyword">BY</span> cust_name;</span><br></pre></td></tr></table></figure>
<p>也可以将子查询的结果作为UPDATE语句的插入值。</p>
<h1 id="十二-JOIN"><a href="#十二-JOIN" class="headerlink" title="十二.JOIN"></a>十二.JOIN</h1><p>使用 JOIN 关键字连接多张表，并且条件语句使用 ON 而不是 WHERE。</p>
<p>连接可以替换子查询，并且比子查询的效率一般会更快。</p>
<p>可以用 AS 给列名、计算字段和表名取别名（AS可省略），给表名取别名是为了简化 SQL 语句以及连接相同表。</p>
<h2 id="内连接"><a href="#内连接" class="headerlink" title="内连接"></a>内连接</h2><p>内连接又称<strong>等值连接</strong>，使用 INNER JOIN 关键字。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> A.value, B.value</span><br><span class="line"><span class="keyword">FROM</span> tablea <span class="keyword">AS</span> A <span class="keyword">INNER</span> <span class="keyword">JOIN</span> tableb <span class="keyword">AS</span> B</span><br><span class="line"><span class="keyword">ON</span> A.key = B.key;</span><br></pre></td></tr></table></figure>
<p>也可以不明确使用 INNER JOIN，而使用普通查询并在 WHERE 中将两个表中要连接的列用等值方法连接起来。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> A.value, B.value</span><br><span class="line"><span class="keyword">FROM</span> tablea A, tableb B</span><br><span class="line"><span class="keyword">WHERE</span> A.key = B.key;</span><br></pre></td></tr></table></figure>
<h2 id="自连接"><a href="#自连接" class="headerlink" title="自连接"></a>自连接</h2><p>自连接可以看成内连接的一种，只是连接的表是自身而已。</p>
<p>一张员工表，包含员工姓名和员工所属部门，要找出与 Jim 处在同一部门的所有员工姓名。</p>
<p>子查询版本</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span> <span class="keyword">FROM</span> employee</span><br><span class="line"><span class="keyword">WHERE</span> department = (</span><br><span class="line">      <span class="keyword">SELECT</span> department</span><br><span class="line">      <span class="keyword">FROM</span> employee</span><br><span class="line">      <span class="keyword">WHERE</span> <span class="keyword">name</span> = <span class="string">"Jim"</span>);</span><br></pre></td></tr></table></figure>
<p>自连接版本</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> e1.name </span><br><span class="line"><span class="keyword">FROM</span> employee e1 <span class="keyword">INNER</span> <span class="keyword">JOIN</span> employee e2</span><br><span class="line"><span class="keyword">ON</span> e1.department = e2.department</span><br><span class="line">      <span class="keyword">AND</span> e2.name = <span class="string">"Jim"</span>;</span><br></pre></td></tr></table></figure>
<p>应使用自连接而非子查询。</p>
<h2 id="外部连接"><a href="#外部连接" class="headerlink" title="外部连接"></a>外部连接</h2><p>外连接保留了没有关联的那些行。分为左外连接，右外连接以及全外连接。<strong>MySQL不支持全外连接，需要左外连接和右外连接结合UNION实现全外连接的效果。</strong></p>
<ul>
<li>左外连接：LEFT OUTER JOIN</li>
<li>右外连接：RIGHT OUTER JOIN。其中OUTER可省略。</li>
</ul>
<p>检索所有顾客的订单信息，包括还没有订单信息的顾客。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Customers.cust_id, Customer.cust_name, Orders.order_id</span><br><span class="line"><span class="keyword">FROM</span> Customers <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> Orders</span><br><span class="line"><span class="keyword">ON</span> Customers.cust_id = Orders.cust_id;</span><br></pre></td></tr></table></figure>
<h1 id="十三-UNION"><a href="#十三-UNION" class="headerlink" title="十三.UNION"></a>十三.UNION</h1><p>使用 <strong>UNION</strong> 来组合两个查询，如果第一个查询返回 M 行，第二个查询返回 N 行，那么组合查询的结果一般为 M+N 行。</p>
<p><strong>每个查询必须包含相同的列、表达式和聚集函数</strong>。</p>
<p>默认会去除相同行，如果需要保留相同行，使用 UNION ALL。</p>
<p>只能包含一个 ORDER BY 子句，并且必须位于语句的最后。</p>
<p>实现全外连接：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 由于不存在有订单信息却没有没有顾客信息的情况，因此该例没有实际意义，仅作全外连接实现的演示</span></span><br><span class="line"><span class="keyword">SELECT</span> Customers.cust_id, Customer.cust_name, Orders.order_id</span><br><span class="line"><span class="keyword">FROM</span> Customers <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Orders</span><br><span class="line"><span class="keyword">ON</span> Customers.cust_id = Orders.cust_id</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> Customers.cust_id, Customer.cust_name, Orders.order_id</span><br><span class="line"><span class="keyword">FROM</span> Customers <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> Orders</span><br><span class="line"><span class="keyword">ON</span> Customers.cust_id = Orders.cust_id;</span><br></pre></td></tr></table></figure>
<h1 id="十四-视图"><a href="#十四-视图" class="headerlink" title="十四.视图"></a>十四.视图</h1><p>视图是虚拟的表，它由一个SQL查询来定义，可以当作表使用。与持久表不同的是，视图中的数据没有实际的物理存储，因此不能对其进行索引操作。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> myview <span class="keyword">AS</span> <span class="keyword">SELECT</span>语句;</span><br></pre></td></tr></table></figure>
<p>视图的作用：</p>
<ul>
<li>可只使用实际表的一部分数据。</li>
<li>通过只给用户访问视图的权限，保证数据的安全性。</li>
</ul>
<h1 id="十五-事务管理"><a href="#十五-事务管理" class="headerlink" title="十五.事务管理"></a>十五.事务管理</h1><p><strong>事务术语</strong>：</p>
<ul>
<li><p>事务（transaction）：指一组SQL语句。</p>
</li>
<li><p>回退（rollback）：指撤销指定SQL语句的过程。</p>
</li>
<li><p>提交（commit）：指将未存储的SQL语句结果写入数据库表。</p>
</li>
<li><p>保留点（savepoint）：指事务处理中设置的临时占位符，可以对它发布回退。</p>
</li>
</ul>
<p>标识事务的开始：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">START</span> <span class="keyword">TRANSACTION</span>;</span><br></pre></td></tr></table></figure>
<p>回退：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ROLLBACK</span>;</span><br></pre></td></tr></table></figure>
<p><strong>事务处理用来管理INSERT, UPDATE和DELETE，你不能回退SELECT语句，CREATE语句和DROP操作</strong>。</p>
<p>在事务块中，需要手动提交：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>
<p><strong>为了支持回退部分事务处理</strong>，必须在事务处理块中合适的位置放置占位符，这样，如果需要回退，可以回退到某个占位符。创建占位符：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SAVEPOINT</span> delete1;</span><br><span class="line"><span class="comment">-- Some SQL statements;</span></span><br><span class="line"><span class="keyword">ROLLBACK</span> <span class="keyword">TO</span> delete1; <span class="comment">-- 回退到保留点delete1</span></span><br></pre></td></tr></table></figure>
<p>保留点在事务处理完成后自动释放，也可明确释放保留点：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RELEASE</span> <span class="keyword">SAVEPOINT</span> delete1;</span><br></pre></td></tr></table></figure>
<h1 id="十六-安全管理"><a href="#十六-安全管理" class="headerlink" title="十六.安全管理"></a>十六.安全管理</h1><p><strong>MySQL 的账户信息保存在 mysql 这个数据库中</strong>。</p>
<p><strong>查看用户</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">USE</span> mysql;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">user</span> <span class="keyword">FROM</span> <span class="keyword">user</span>;</span><br></pre></td></tr></table></figure>
<p><strong>创建账户</strong></p>
<p>新创建的账户没有任何权限。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> myuser <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">'mypassword'</span>;</span><br></pre></td></tr></table></figure>
<p><strong>修改账户名</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RENAME</span> <span class="keyword">USER</span> myuser <span class="keyword">TO</span> newuser;</span><br></pre></td></tr></table></figure>
<p><strong>删除账户</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">USER</span> myuser;</span><br></pre></td></tr></table></figure>
<p><strong>查看权限</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">GRANTS</span> <span class="keyword">FOR</span> myuser;</span><br></pre></td></tr></table></figure>
<p><strong>授予权限</strong></p>
<p>账户用 username@host 的形式定义，username@% 使用的是默认主机名。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 授权myuser对数据库mydatabase的所有表有select和insert权限</span></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span>, <span class="keyword">INSERT</span> <span class="keyword">ON</span> mydatabase.* <span class="keyword">TO</span> myuser;</span><br></pre></td></tr></table></figure>
<p><strong>删除权限</strong></p>
<p>GRANT 和 REVOKE 可在几个层次上控制访问权限：</p>
<ul>
<li>整个服务器，使用 GRANT ALL 和 REVOKE ALL；</li>
<li>整个数据库，使用 ON database.*；</li>
<li>特定的表，使用 ON database.table；</li>
<li>特定的列；</li>
<li>特定的存储过程。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">SELECT</span>, <span class="keyword">INSERT</span> <span class="keyword">ON</span> mydatabase.* <span class="keyword">FROM</span> myuser;</span><br></pre></td></tr></table></figure>
<p>具体有哪些权限可参照MySQL必知必会表28-1。</p>
<p><strong>更改密码</strong></p>
<p>必须使用 Password() 函数进行加密。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> PASSWROD <span class="keyword">FOR</span> myuser = <span class="keyword">Password</span>(<span class="string">'new_password'</span>);</span><br><span class="line"><span class="keyword">SET</span> PASSWROD = <span class="keyword">Password</span>(<span class="string">'new_password'</span>); <span class="comment">--不指定用户名则更新当前登录用户的密码</span></span><br></pre></td></tr></table></figure>
<h1 id="十七-范式"><a href="#十七-范式" class="headerlink" title="十七.范式"></a>十七.范式</h1><h2 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h2><ul>
<li><p>减少数据冗余。</p>
</li>
<li><p>消除插入、更新和删除异常。</p>
</li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p><strong>1NF</strong></p>
<p><strong>表的每一个字段都是最小单元，不可再分</strong>。</p>
<p>实践：数据库设计画ER图时对实体做好分析可满足1NF。</p>
<p><strong>2NF</strong></p>
<p><strong>满足1NF，且表中的字段必须完全依赖于全部主键而非部分主键</strong>。</p>
<p>实践：一张表只设一个主键，若该表满足1NF，则一定满足2NF。</p>
<p><strong>3NF</strong></p>
<p><strong>满足2NF，且非主键外的所有字段必须互不依赖，即消除了依赖传递</strong>，例如：主键决定字段A，字段A决定字段B，则主键可决定字段B，这就是依赖传递。</p>
<p>实践：若存在相互依赖的字段，则它们应单独在一张表中，比如前面例子中字段A, B应单独在一张表中。</p>
<p><strong>BCNF</strong></p>
<p><strong>满足3NF，且每张表中只有一个唯一索引（一般为主键）。</strong></p>
<p>实践：MySQL中一般不用。以user表为例，假设该user表有手机号tel字段，每个人的手机号都是唯一的，显然用手机号做主键是不合适的，此时一般还是需要自定义一个自增id。这里就有两个唯一索引了，不满足BCNF。那么为了满足BCNF，我们需要单独建表存储一个id号和手机号tel字段，这样查询性能会降低。</p>
<p><strong>4NF</strong></p>
<p><strong>满足3NF，且消除表中字段的多值依赖。</strong></p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ol>
<li>MySQL 必知必会 / (英) Forta, B 著；刘晓霞，钟铭译. -北京：人民邮电出版社，2009.1</li>
<li><a href="www.cyc2018.xyz">CS-Notes</a></li>
</ol>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://thmasterplan.cn/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL%E5%9F%BA%E7%A1%80/" title="MySQL基础" target="_blank" rel="external">Blog of TheMasterplan</a>
    </li>

    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/Laishiji" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/Laishiji" target="_blank"><span class="text-dark">TheMasterplan</span><small class="ml-1x">Java Developer</small></a></h3>
        <div>練習時長兩年半のCV戰士</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="lv-container" data-id="city" data-uid="MTAyMC80NzU5OS8yNDA5OQ==">
        <noscript> 为正常使用来必力评论功能请激活JavaScript</noscript>
      </div>    
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL%E9%94%81/" title="MySQL之锁"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;Newer</span></a>
    </li>
    
    
    <li class="next">
      <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%85%A5%E9%97%A8/" title="Redis入门"><span>Older&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="Catalogue" role="button">
        <span>[&nbsp;</span><span>Catalogue</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  
  <div class="bar-right">
    
  </div>
  </div>
</nav>
  


</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/Laishiji" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        &copy; 2021 LSJ
        
    </div>
</footer>

  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   




   
    
<script defer type="text/javascript">
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];

    if (typeof LivereTower === 'function') { return; }

    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;

    e.parentNode.insertBefore(j, e);
  })(document, 'script');
</script>




  <script src="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.3.5/dist/jquery.fancybox.min.js"></script>
  <script>
  //利用 FancyBox 实现点击图片放大
  $(document).ready(function() {
    $('article img').not('[hidden]').not('.panel-body img').each(function() {
      var $image = $(this);
      var imageCaption = $image.attr('alt');
      var $imageWrapLink = $image.parent('a');
      if ($imageWrapLink.length < 1) {
        var src = this.getAttribute('src');
        var idx = src.lastIndexOf('?');
        if (idx != -1) {
          src = src.substring(0, idx);
        }
        $imageWrapLink = $image.wrap('<a href="' + src + '"></a>').parent('a');
      }
      $imageWrapLink.attr('data-fancybox', 'images');
      if (imageCaption) {
        $imageWrapLink.attr('data-caption', imageCaption);
      }
    });
    $().fancybox({
      selector: '[data-fancybox="images"]',
      hash: false,
      loop: false,
    });
  });
  </script>





<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<!-- <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->

</body>
</html>